"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const codemod_1 = require("../utils/codemod");
function save(root, importStyle, api, opts) {
    importStyle.replaceWith(() => {
        const style = codemod_1.styleFile(opts);
        return api.j.importDeclaration([], api.j.stringLiteral(style));
    });
    const imports = codemod_1.importStatement(true, opts);
    codemod_1.addImport(root, api, imports);
}
exports.default = (root, api, opts) => {
    const { remove } = opts;
    const importStyle = root.find(api.jscodeshift.ImportDeclaration, (ast) => {
        const { specifiers, source } = ast;
        const stringLiteral = api.jscodeshift.StringLiteral;
        const style = codemod_1.styleFile(opts);
        const exist = codemod_1.equalsIgnoreSuffix(style, source.value);
        return !specifiers.length && stringLiteral.check(source) && exist;
    });
    if (remove) {
        importStyle.remove();
    }
    else {
        save(root, importStyle, api, opts);
    }
};
