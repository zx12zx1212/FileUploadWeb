{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { defineComponent, onBeforeUnmount, onMounted, onUpdated, ref } from 'vue';\nimport initDefaultProps from '../_util/props-util/initDefaultProps';\nimport Statistic, { statisticProps } from './Statistic';\nimport { formatCountdown as formatCD } from './utils';\nvar REFRESH_INTERVAL = 1000 / 30;\nfunction getTime(value) {\n  return new Date(value).getTime();\n}\nexport default defineComponent({\n  name: 'AStatisticCountdown',\n  props: initDefaultProps(statisticProps, {\n    format: 'HH:mm:ss'\n  }),\n  emits: ['finish', 'change'],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var countdownId = ref();\n    var statistic = ref();\n    var syncTimer = function syncTimer() {\n      var value = props.value;\n      var timestamp = getTime(value);\n      if (timestamp >= Date.now()) {\n        startTimer();\n      } else {\n        stopTimer();\n      }\n    };\n    var startTimer = function startTimer() {\n      if (countdownId.value) return;\n      var timestamp = getTime(props.value);\n      countdownId.value = window.setInterval(function () {\n        statistic.value.$forceUpdate();\n        if (timestamp > Date.now()) {\n          emit('change', timestamp - Date.now());\n        }\n        syncTimer();\n      }, REFRESH_INTERVAL);\n    };\n    var stopTimer = function stopTimer() {\n      var value = props.value;\n      if (countdownId.value) {\n        clearInterval(countdownId.value);\n        countdownId.value = undefined;\n        var timestamp = getTime(value);\n        if (timestamp < Date.now()) {\n          emit('finish');\n        }\n      }\n    };\n    var formatCountdown = function formatCountdown(_ref2) {\n      var value = _ref2.value,\n        config = _ref2.config;\n      var format = props.format;\n      return formatCD(value, _extends(_extends({}, config), {\n        format: format\n      }));\n    };\n    var valueRenderHtml = function valueRenderHtml(node) {\n      return node;\n    };\n    onMounted(function () {\n      syncTimer();\n    });\n    onUpdated(function () {\n      syncTimer();\n    });\n    onBeforeUnmount(function () {\n      stopTimer();\n    });\n    return function () {\n      return _createVNode(Statistic, _objectSpread({\n        \"ref\": statistic\n      }, _extends(_extends({}, props), {\n        valueRender: valueRenderHtml,\n        formatter: formatCountdown\n      })), null);\n    };\n  }\n});","map":{"version":3,"names":["_objectSpread","_extends","createVNode","_createVNode","defineComponent","onBeforeUnmount","onMounted","onUpdated","ref","initDefaultProps","Statistic","statisticProps","formatCountdown","formatCD","REFRESH_INTERVAL","getTime","value","Date","name","props","format","emits","setup","_ref","emit","countdownId","statistic","syncTimer","timestamp","now","startTimer","stopTimer","window","setInterval","$forceUpdate","clearInterval","undefined","_ref2","config","valueRenderHtml","node","valueRender","formatter"],"sources":["/Users/lyonxie/Desktop/test/node_modules/ant-design-vue/es/statistic/Countdown.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { defineComponent, onBeforeUnmount, onMounted, onUpdated, ref } from 'vue';\nimport initDefaultProps from '../_util/props-util/initDefaultProps';\nimport Statistic, { statisticProps } from './Statistic';\nimport { formatCountdown as formatCD } from './utils';\nvar REFRESH_INTERVAL = 1000 / 30;\n\nfunction getTime(value) {\n  return new Date(value).getTime();\n}\n\nexport default defineComponent({\n  name: 'AStatisticCountdown',\n  props: initDefaultProps(statisticProps, {\n    format: 'HH:mm:ss'\n  }),\n  emits: ['finish', 'change'],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var countdownId = ref();\n    var statistic = ref();\n\n    var syncTimer = function syncTimer() {\n      var value = props.value;\n      var timestamp = getTime(value);\n\n      if (timestamp >= Date.now()) {\n        startTimer();\n      } else {\n        stopTimer();\n      }\n    };\n\n    var startTimer = function startTimer() {\n      if (countdownId.value) return;\n      var timestamp = getTime(props.value);\n      countdownId.value = window.setInterval(function () {\n        statistic.value.$forceUpdate();\n\n        if (timestamp > Date.now()) {\n          emit('change', timestamp - Date.now());\n        }\n\n        syncTimer();\n      }, REFRESH_INTERVAL);\n    };\n\n    var stopTimer = function stopTimer() {\n      var value = props.value;\n\n      if (countdownId.value) {\n        clearInterval(countdownId.value);\n        countdownId.value = undefined;\n        var timestamp = getTime(value);\n\n        if (timestamp < Date.now()) {\n          emit('finish');\n        }\n      }\n    };\n\n    var formatCountdown = function formatCountdown(_ref2) {\n      var value = _ref2.value,\n          config = _ref2.config;\n      var format = props.format;\n      return formatCD(value, _extends(_extends({}, config), {\n        format: format\n      }));\n    };\n\n    var valueRenderHtml = function valueRenderHtml(node) {\n      return node;\n    };\n\n    onMounted(function () {\n      syncTimer();\n    });\n    onUpdated(function () {\n      syncTimer();\n    });\n    onBeforeUnmount(function () {\n      stopTimer();\n    });\n    return function () {\n      return _createVNode(Statistic, _objectSpread({\n        \"ref\": statistic\n      }, _extends(_extends({}, props), {\n        valueRender: valueRenderHtml,\n        formatter: formatCountdown\n      })), null);\n    };\n  }\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}