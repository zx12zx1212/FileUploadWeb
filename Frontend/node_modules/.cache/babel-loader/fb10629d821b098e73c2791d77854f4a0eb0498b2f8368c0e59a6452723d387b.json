{"ast":null,"code":"function getError(option, xhr) {\n  var msg = \"cannot \".concat(option.method, \" \").concat(option.action, \" \").concat(xhr.status, \"'\");\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = option.method;\n  err.url = option.action;\n  return err;\n}\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n  if (!text) {\n    return text;\n  }\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n} // option {\n//  onProgress: (event: { percent: number }): void,\n//  onError: (event: Error, body?: Object): void,\n//  onSuccess: (body: Object): void,\n//  data: Object,\n//  filename: String,\n//  file: File,\n//  withCredentials: Boolean,\n//  action: String,\n//  headers: Object,\n// }\n\nexport default function upload(option) {\n  var xhr = new window.XMLHttpRequest();\n  if (option.onProgress && xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n      option.onProgress(e);\n    };\n  }\n  var formData = new window.FormData();\n  if (option.data) {\n    Object.keys(option.data).forEach(function (key) {\n      var value = option.data[key]; // support key-value array data\n\n      if (Array.isArray(value)) {\n        value.forEach(function (item) {\n          // { list: [ 11, 22 ] }\n          // formData.append('list[]', 11);\n          formData.append(\"\".concat(key, \"[]\"), item);\n        });\n        return;\n      }\n      formData.append(key, option.data[key]);\n    });\n  }\n  formData.append(option.filename, option.file);\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n  xhr.onload = function onload() {\n    // allow success when 2xx status\n    // see https://github.com/react-component/upload/issues/34\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(option, xhr), getBody(xhr));\n    }\n    option.onSuccess(getBody(xhr), xhr);\n  };\n  xhr.open(option.method, option.action, true); // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n  var headers = option.headers || {}; // when set headers['X-Requested-With'] = null , can close default XHR header\n  // see https://github.com/react-component/upload/issues/33\n\n  if (headers['X-Requested-With'] !== null) {\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n  }\n  for (var h in headers) {\n    if (headers.hasOwnProperty(h) && headers[h] !== null) {\n      xhr.setRequestHeader(h, headers[h]);\n    }\n  }\n  xhr.send(formData);\n  return {\n    abort: function abort() {\n      xhr.abort();\n    }\n  };\n}","map":{"version":3,"names":["getError","option","xhr","msg","concat","method","action","status","err","Error","url","getBody","text","responseText","response","JSON","parse","e","upload","window","XMLHttpRequest","onProgress","onprogress","progress","total","percent","loaded","formData","FormData","data","Object","keys","forEach","key","value","Array","isArray","item","append","filename","file","onerror","error","onError","onload","onSuccess","open","withCredentials","headers","setRequestHeader","h","hasOwnProperty","send","abort"],"sources":["/Users/lyonxie/Desktop/test/node_modules/ant-design-vue/es/vc-upload/src/request.js"],"sourcesContent":["function getError(option, xhr) {\n  var msg = \"cannot \".concat(option.method, \" \").concat(option.action, \" \").concat(xhr.status, \"'\");\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = option.method;\n  err.url = option.action;\n  return err;\n}\n\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n\n  if (!text) {\n    return text;\n  }\n\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n} // option {\n//  onProgress: (event: { percent: number }): void,\n//  onError: (event: Error, body?: Object): void,\n//  onSuccess: (body: Object): void,\n//  data: Object,\n//  filename: String,\n//  file: File,\n//  withCredentials: Boolean,\n//  action: String,\n//  headers: Object,\n// }\n\n\nexport default function upload(option) {\n  var xhr = new window.XMLHttpRequest();\n\n  if (option.onProgress && xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n\n      option.onProgress(e);\n    };\n  }\n\n  var formData = new window.FormData();\n\n  if (option.data) {\n    Object.keys(option.data).forEach(function (key) {\n      var value = option.data[key]; // support key-value array data\n\n      if (Array.isArray(value)) {\n        value.forEach(function (item) {\n          // { list: [ 11, 22 ] }\n          // formData.append('list[]', 11);\n          formData.append(\"\".concat(key, \"[]\"), item);\n        });\n        return;\n      }\n\n      formData.append(key, option.data[key]);\n    });\n  }\n\n  formData.append(option.filename, option.file);\n\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n\n  xhr.onload = function onload() {\n    // allow success when 2xx status\n    // see https://github.com/react-component/upload/issues/34\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(option, xhr), getBody(xhr));\n    }\n\n    option.onSuccess(getBody(xhr), xhr);\n  };\n\n  xhr.open(option.method, option.action, true); // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n\n  var headers = option.headers || {}; // when set headers['X-Requested-With'] = null , can close default XHR header\n  // see https://github.com/react-component/upload/issues/33\n\n  if (headers['X-Requested-With'] !== null) {\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n  }\n\n  for (var h in headers) {\n    if (headers.hasOwnProperty(h) && headers[h] !== null) {\n      xhr.setRequestHeader(h, headers[h]);\n    }\n  }\n\n  xhr.send(formData);\n  return {\n    abort: function abort() {\n      xhr.abort();\n    }\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}